# 2025.08.30. 밸런싱 안정화 과정

- 파라미터를 계속 조정해도 잘 안됐다.

- 바퀴가 흔들려서 디이소 간 후 드라이버를 구입하여 나사를 쪼였다. 규격은 3이었다.
```xml
<!-- 밸런싱 PID 게인 (Roll 각도 제어) - Phase 0: 긴급 안정화 -->
<param name="pid_kp_balance" value="9.0"/>   <!-- 0.8 → 0.3 극도로 보수적 -->
<param name="pid_ki_balance" value="2.0"/>   <!-- 적분 항 완전 제거 -->
<param name="pid_kd_balance" value="0.5"/>  <!-- 0.1 → 0.05 미분 최소화 -->
```

- 원격 VNC 설정
https://developer.nvidia.com/embedded/learn/tutorials/vnc-setup
- Jetson Nano가 LXDE 기반인지, GNOME 기반인지 검색하려고 했다.
https://superuser.com/questions/96151/how-do-i-check-whether-i-am-using-kde-or-gnome
```bash
# Website엔 나왔지만, Jetson Nano 기준 안 된 것들
echo $DESKTOP_SESSION
echo $XDG_CURRENT_DESKTOP

# Jetson Nano 기준 된 것들
ps -ef | grep gnome
```
- 결과는 Jetson nano는 LXDE 기반 그래픽이었다.

- rqt plot
https://m.blog.naver.com/zeta0807/221775210962
```bash
rqt
# 실행 후
# Plugin -> Visualization -> Plot 선택
# Topic 옆의 Edittext view에서 '/' 입력하면 현재 실행중인 roscore 노드가 발행하고 있는 Topics를 연결할 수 있다.
```

- ROS Topic에 대해
- https://conceptbug.tistory.com/entry/ROS-%ED%8A%9C%ED%86%A0%EB%A6%AC%EC%96%BC-116-ROS%EC%9D%98-%ED%86%A0%ED%94%BDtopic%EC%97%90-%EB%8C%80%ED%95%9C-%EC%9D%B4%ED%95%B4
- 결국 기존 사이드 프로젝트 `src\balance_robot_nodes`를 가져왔다.

- PID 값을 많이 바꾸었다.
    - PID 4.5 3 0.7 => 못 따라감
    - PID 9.0 2 0.5 => 그나마 최적
- PID제어의 목표값 0이 수직을 의미하는 것이 아니므로, 센서 위치 오차로 추정되는 값으로 넣어주었다.
    - roll_angle target = -0.5 : (부족, 여전히 같은 방향으로 차체가 기운다.) 
    - -1.0 : (과도, 반대방향으로 과도하게 쏠린다.)
    - -0.7 : (적정, PID 제어량이 제어 가능할 정도의 범위다.)

- 가끔 각도가 0에서 -5 ~ -10으로 튀는 현상이 발생한다.
![image](/docs/개발과정/image/2025-08-30%20192834.png)

- 꽤나 정상적인 그래프
![image](/docs/개발과정/image/2025-08-30%20195339.png)
![image](/docs/개발과정/image/2025-08-30%20194855.png)

## 다음 step
- 바퀴수 기반으로 목표 각도를 조절함으로써 차체가 멀리 달아나지 않도록 한다.
- 배터리, 센서 등 요소를 더 정확하게 고정한다.